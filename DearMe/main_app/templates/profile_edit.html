{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block head %}
<link rel="stylesheet" href="{% static 'css/profile.css' %}">
{% endblock %}

{% block content %}
<div class="profile-form-container">
    <h1 class="profile-form-title">Edit Profile</h1>

    <form method="post" enctype="multipart/form-data" class="profile-form">
        {% csrf_token %}

        <!-- Profile Picture -->
        <div class="profile-picture">
            <label for="id_profile_picture">
                {% if user_obj.profile_picture %}
                    <img src="{{ user_obj.profile_picture.url }}" alt="Profile Picture" class="profile-pic"/>
                    <p>Click to change</p>
                {% else %}
                    <img src="{% static 'images/default-profile.png' %}" alt="Profile Picture" class="profile-pic"/>
                    <p>Click to upload</p>
                {% endif %}
            </label>
            {{ form.profile_picture }} <!-- hidden input still here -->
        </div>


        <!-- Profile Fields -->
        <div class="form-fields">
            {{ form.username|as_crispy_field }}
            {{ form.email|as_crispy_field }}
            {{ form.first_name|as_crispy_field }}
            {{ form.last_name|as_crispy_field }}

            <!-- Hide Name Checkbox (cleaned) -->
            <div class="checkbox-group">
                {{ form.hide_name }}
                <label for="{{ form.hide_name.id_for_label }}">Hide my name publicly</label>
            </div>

            {{ form.birthday|as_crispy_field }}
        </div>

        <!-- Save Button -->
        <div class="form-buttons">
            <button type="submit" class="btn-submit">Save Changes</button>
        </div>
    </form>

    <!-- Delete Account -->
    <form method="post" action="{% url 'delete_profile' %}" class="profile-form delete-form" 
          onsubmit="return confirm('Are you sure? This will permanently delete your account and all data.')">
        {% csrf_token %}
        <div class="form-buttons">
            <button type="submit" class="btn-cancel">Delete Account</button>
        </div>
    </form>
</div>
{% endblock %}
